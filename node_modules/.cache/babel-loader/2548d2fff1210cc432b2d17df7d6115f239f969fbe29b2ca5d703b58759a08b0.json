{"ast":null,"code":"import \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { defineComponent, getCurrentInstance, inject, watch, onUnmounted, h } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport useLayoutObserver from '../layout-observer.mjs';\nimport { removePopper } from '../util.mjs';\nimport { TABLE_INJECTION_KEY } from '../tokens.mjs';\nimport useRender from './render-helper.mjs';\nimport defaultProps from './defaults.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { isClient } from '@vueuse/core';\nimport { rAF } from '../../../../utils/raf.mjs';\nimport { removeClass, addClass } from '../../../../utils/dom/style.mjs';\nvar TableBody = defineComponent({\n  name: \"ElTableBody\",\n  props: defaultProps,\n  setup: function setup(props) {\n    var instance = getCurrentInstance();\n    var parent = inject(TABLE_INJECTION_KEY);\n    var ns = useNamespace(\"table\");\n    var _useRender = useRender(props),\n      wrappedRowRender = _useRender.wrappedRowRender,\n      tooltipContent = _useRender.tooltipContent,\n      tooltipTrigger = _useRender.tooltipTrigger;\n    var _useLayoutObserver = useLayoutObserver(parent),\n      onColumnsChange = _useLayoutObserver.onColumnsChange,\n      onScrollableChange = _useLayoutObserver.onScrollableChange;\n    watch(props.store.states.hoverRow, function (newVal, oldVal) {\n      if (!props.store.states.isComplex.value || !isClient) return;\n      rAF(function () {\n        var el = instance == null ? void 0 : instance.vnode.el;\n        var rows = Array.from((el == null ? void 0 : el.children) || []).filter(function (e) {\n          return e == null ? void 0 : e.classList.contains(\"\".concat(ns.e(\"row\")));\n        });\n        var oldRow = rows[oldVal];\n        var newRow = rows[newVal];\n        if (oldRow) {\n          removeClass(oldRow, \"hover-row\");\n        }\n        if (newRow) {\n          addClass(newRow, \"hover-row\");\n        }\n      });\n    });\n    onUnmounted(function () {\n      var _a;\n      (_a = removePopper) == null ? void 0 : _a();\n    });\n    return {\n      ns: ns,\n      onColumnsChange: onColumnsChange,\n      onScrollableChange: onScrollableChange,\n      wrappedRowRender: wrappedRowRender,\n      tooltipContent: tooltipContent,\n      tooltipTrigger: tooltipTrigger\n    };\n  },\n  render: function render() {\n    var wrappedRowRender = this.wrappedRowRender,\n      store = this.store;\n    var data = store.states.data.value || [];\n    return h(\"tbody\", {\n      tabIndex: -1\n    }, [data.reduce(function (acc, row) {\n      return acc.concat(wrappedRowRender(row, acc.length));\n    }, [])]);\n  }\n});\nexport { TableBody as default };","map":{"version":3,"names":["TableBody","defineComponent","name","props","defaultProps","setup","instance","getCurrentInstance","parent","inject","TABLE_INJECTION_KEY","ns","useNamespace","_useRender","useRender","wrappedRowRender","tooltipContent","tooltipTrigger","_useLayoutObserver","useLayoutObserver","onColumnsChange","onScrollableChange","watch","store","states","hoverRow","newVal","oldVal","isComplex","value","isClient","rAF","el","vnode","rows","Array","from","children","filter","e","classList","contains","concat","oldRow","newRow","removeClass","addClass","onUnmounted","_a","removePopper","render","data","h","tabIndex","reduce","acc","row","length"],"sources":["../../../../../../../packages/components/table/src/table-body/index.ts"],"sourcesContent":["// @ts-nocheck\nimport {\n  defineComponent,\n  getCurrentInstance,\n  h,\n  inject,\n  onUnmounted,\n  watch,\n} from 'vue'\nimport { addClass, isClient, rAF, removeClass } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport useLayoutObserver from '../layout-observer'\nimport { removePopper } from '../util'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport useRender from './render-helper'\nimport defaultProps from './defaults'\n\nimport type { VNode } from 'vue'\n\nexport default defineComponent({\n  name: 'ElTableBody',\n  props: defaultProps,\n  setup(props) {\n    const instance = getCurrentInstance()\n    const parent = inject(TABLE_INJECTION_KEY)\n    const ns = useNamespace('table')\n    const { wrappedRowRender, tooltipContent, tooltipTrigger } =\n      useRender(props)\n    const { onColumnsChange, onScrollableChange } = useLayoutObserver(parent!)\n\n    watch(props.store.states.hoverRow, (newVal: any, oldVal: any) => {\n      if (!props.store.states.isComplex.value || !isClient) return\n\n      rAF(() => {\n        // just get first level children; fix #9723\n        const el = instance?.vnode.el as HTMLElement\n        const rows = Array.from(el?.children || []).filter((e) =>\n          e?.classList.contains(`${ns.e('row')}`)\n        )\n        const oldRow = rows[oldVal]\n        const newRow = rows[newVal]\n        if (oldRow) {\n          removeClass(oldRow, 'hover-row')\n        }\n        if (newRow) {\n          addClass(newRow, 'hover-row')\n        }\n      })\n    })\n\n    onUnmounted(() => {\n      removePopper?.()\n    })\n\n    return {\n      ns,\n      onColumnsChange,\n      onScrollableChange,\n      wrappedRowRender,\n      tooltipContent,\n      tooltipTrigger,\n    }\n  },\n  render() {\n    const { wrappedRowRender, store } = this\n    const data = store.states.data.value || []\n    // Why do we need tabIndex: -1 ?\n    // If you set the tabindex attribute on an element ,\n    // then its child content cannot be scrolled with the arrow keys,\n    // unless you set tabindex on the content too\n    // See https://github.com/facebook/react/issues/25462#issuecomment-1274775248 or https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/tabindex\n    return h('tbody', { tabIndex: -1 }, [\n      data.reduce((acc: VNode[], row) => {\n        return acc.concat(wrappedRowRender(row, acc.length))\n      }, []),\n    ])\n  },\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}